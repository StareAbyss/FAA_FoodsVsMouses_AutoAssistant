from function.common.bg_img_match import match_p_in_w
from function.globals.init_resources import RESOURCE_P
from function.scattered.gat_handle import faa_get_handle


def get_position_card_deck_in_battle(handle,handle_360):
    """识别火苗偏移 True 代表13+张卡 否则 12-张卡"""
    # 循环查找火苗图标 找到战斗开始
    find = match_p_in_w(
        source_handle=handle,
        source_root_handle=handle_360,
        source_range=[0, 0, 950, 600],
        template=RESOURCE_P["common"]["战斗"]["战斗中_火苗能量.png"])
    if find == [175, 36]:
        my_dict = {
            1: [257, 74],
            2: [310, 74],
            3: [363, 74],
            4: [416, 74],
            5: [469, 74],
            6: [522, 74],
            7: [575, 74],
            8: [628, 74],
            9: [681, 74],
            10: [734, 74],
            11: [787, 74],
            12: [840, 74]}

    else:
        my_dict = {
            1: [236, 74],
            2: [289, 74],
            3: [342, 74],
            4: [395, 74],
            5: [448, 74],
            6: [501, 74],
            7: [554, 74],
            8: [607, 74],
            9: [660, 74],
            10: [713, 74],
            11: [766, 74],
            12: [819, 74],
            13: [872, 74],
            14: [925, 74],
            15: [925, 142],
            16: [925, 210],
            17: [925, 278],
            18: [925, 346],
            19: [925, 414],
            20: [925, 482],
            21: [925, 550]
        }
    return my_dict


def get_position_card_cell_in_battle():
    """创建战斗中的 选卡槽和部署位→映射坐标"""

    # 坐标是左上为1-1 往右-往下
    my_dict = {
        '1-1': [332, 143],
        '1-2': [332, 206],
        '1-3': [332, 270],
        '1-4': [332, 315],
        '1-5': [332, 397],
        '1-6': [332, 461],
        '1-7': [332, 525],
        '2-1': [392, 143],
        '2-2': [392, 206],
        '2-3': [392, 270],
        '2-4': [392, 315],
        '2-5': [392, 397],
        '2-6': [392, 461],
        '2-7': [392, 525],
        '3-1': [452, 143],
        '3-2': [452, 206],
        '3-3': [452, 270],
        '3-4': [452, 315],
        '3-5': [452, 397],
        '3-6': [452, 461],
        '3-7': [452, 525],
        '4-1': [512, 143],
        '4-2': [512, 206],
        '4-3': [512, 270],
        '4-4': [512, 315],
        '4-5': [512, 397],
        '4-6': [512, 461],
        '4-7': [512, 525],
        '5-1': [572, 143],
        '5-2': [572, 206],
        '5-3': [572, 270],
        '5-4': [572, 315],
        '5-5': [572, 397],
        '5-6': [572, 461],
        '5-7': [572, 525],
        '6-1': [632, 143],
        '6-2': [632, 206],
        '6-3': [632, 270],
        '6-4': [632, 315],
        '6-5': [632, 397],
        '6-6': [632, 461],
        '6-7': [632, 525],
        '7-1': [692, 143],
        '7-2': [692, 206],
        '7-3': [692, 270],
        '7-4': [692, 315],
        '7-5': [692, 397],
        '7-6': [692, 461],
        '7-7': [692, 525],
        '8-1': [752, 143],
        '8-2': [752, 206],
        '8-3': [752, 270],
        '8-4': [752, 315],
        '8-5': [752, 397],
        '8-6': [752, 461],
        '8-7': [752, 525],
        '9-1': [812, 143],
        '9-2': [812, 206],
        '9-3': [812, 270],
        '9-4': [812, 315],
        '9-5': [812, 397],
        '9-6': [812, 461],
        '9-7': [812, 525],
    }
    return my_dict


if __name__ == '__main__':
    def main():
        handle = faa_get_handle(channel="锑食", mode="flash")
        print(get_position_card_deck_in_battle(handle=handle))


    main()
